var btnLogin=$(".btn-login"),btnRegister=$(".btn-reg"),username=$("#form-username"),password=$("#form-passwd"),passwdAgain=$("#form-passwd_again"),loading=$("#page-loading"),input=$(".input"),lock=!1,checkForm=function(s){return username.val()?password.val()?!(s&&!passwdAgain.val())||(passwdAgain.addClass("error").siblings(".tips").addClass("error"),!1):(password.addClass("error").siblings(".tips").addClass("error"),!1):(username.addClass("error").siblings(".tips").addClass("error"),!1)},login=function(){$.ajax({type:"POST",url:"/api/user/login",data:{name:username.val(),password:password.val()},success:function(s){var r=s.status,a=s.msg;s.data;0===r?$.growl.notice({message:a,destory:function(){window.location.href="/admin"}}):($.growl.error({message:a}),btnLogin.removeClass("loading"))}})},register=function(){$.ajax({type:"POST",url:"/api/user/register",data:{name:username.val(),password:password.val()},success:function(s){var r=s.status,a=s.msg;0===r?$.growl.notice({message:a,destory:function(){window.location.href="/login"}}):($.growl.error({message:a}),btnRegister.removeClass("loading"))}})};input.on("blur",function(){var s=$(this),r=s.val(),a=s.siblings(".tips");r?(s.removeClass("error"),a.removeClass("error")):(s.addClass("error"),a.addClass("error"))}),btnLogin.on("click",function(){checkForm()&&(setTimeout(function(){lock=!1},3e3),lock||(lock=!0,btnLogin.addClass("loading"),login()))}),btnRegister.on("click",function(){checkForm(!0)&&(setTimeout(function(){lock=!1},3e3),lock||(lock=!0,$.growl.error({message:"抱歉, 暂不开放注册!"})))});